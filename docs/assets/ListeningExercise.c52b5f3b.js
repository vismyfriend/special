import{u as oe,r as C,o as le,b as o,c as l,e as c,t as v,F as f,q as w,j as k,s as ne,y as E,w as U,B as F,n as D,k as W,C as ae,D as ce,E as ue}from"./index.c814fdf6.js";import{L as ie}from"./ListeningExerciseData.459b2193.js";import{_ as de}from"./plugin-vue_export-helper.21dcd24c.js";const pe={key:0,class:"exercise-container"},ve={class:"exercise-header"},he={class:"header-bottom"},_e={class:"task-counter"},fe={key:0,class:"useful-words-container"},be={class:"useful-words"},me={class:"useful-words-content"},ge={class:"english-word"},ye={class:"translation"},we={key:0,class:"comma"},ke={class:"task-title"},Ce={key:1,class:"task-image-container"},Ae=["src","alt"],De={key:2,controls:"",class:"audio-player",controlsList:"nodownload",oncontextmenu:"return false;"},Te=["src"],Ee={key:3,class:"true-false-container"},Ue={class:"true-false-table"},$e={class:"radio-label"},Le=["name","onUpdate:modelValue"],Pe={class:"radio-label"},Ve=["name","onUpdate:modelValue"],Fe={key:4,class:"multiple-choice-container"},Oe={class:"question-text"},Se={class:"options-container"},ze=["name","value","onUpdate:modelValue"],Be={class:"option-text"},Ne={key:5,class:"student-input-container"},Me={class:"question-text"},We=["onUpdate:modelValue","onKeyup","data-task","data-question"],Ke={key:0,class:"answer-feedback"},Ge={key:0,class:"correct-answer"},Re={key:1,class:"almost-answer"},je={key:2,class:"incorrect-answer"},Qe={key:6,class:"drop-down-text-container"},Ye={class:"question-text"},He=["onUpdate:modelValue"],Je=["value"],Xe={key:0,class:"answer-feedback"},Ze={key:0,class:"correct-answer"},Ie={key:1,class:"incorrect-answer"},xe={key:7,class:"grid-table-container"},qe={class:"grid-table"},et=["onUpdate:modelValue","placeholder"],tt={key:0,class:"grid-table-feedback"},st={key:0,class:"correct-feedback"},rt={class:"task-footer"},ot={class:"task-controls"},lt=["onClick"],nt=["onClick"],at={key:0,class:"text-script-content"},ct={class:"task-navigation"},ut=["disabled"],it=["disabled"],dt={__name:"ListeningExercise",setup(pt){const K=oe(),_=C(null),d=C([]),g=C([]),L=C(null),$=C([]),O=C(""),A=C(0),y=t=>!t||typeof t!="string"?"":t.toLowerCase().replace(/\s+/g," ").trim().replace(/[.,!?;:…–—]+$/g,"").replace(/[.,!?;:…–—]/g," ").replace(/\s+/g," ").replace(/[`'‘’´]/g,"'").replace(/(\b(?:he|she|it))'?s not\b/g,"$1 is not").replace(/(\b(?:he|she|it)) isn'?t\b/g,"$1 is not").replace(/(\b(?:you|we|they|i))'?re not\b/g,"$1 are not").replace(/(\b(?:you|we|they|i)) aren'?t\b/g,"$1 are not").replace(/\bi'?m not\b/g,"i am not").replace(/\bdo not\b/g,"don't").replace(/\bdoes not\b/g,"doesn't").replace(/\bdid not\b/g,"didn't").replace(/\bwill not\b/g,"won't").replace(/\bcan not\b/g,"can't").replace(/\bmust not\b/g,"mustn't").replace(/\bshould not\b/g,"should't").replace(/\bwould not\b/g,"wouldn't").replace(/\b(?:dont|doesnt|didnt|wont|cant|hadnt|hasnt|mustnt|shouldnt|wouldnt)\b/g,n=>({dont:"don't",doesnt:"doesn't",didnt:"didn't",wont:"won't",cant:"can't",hasnt:"hasn't",hadnt:"hadn't",mustnt:"mustn't",shouldnt:"shouldn't",wouldnt:"wouldn't"})[n]).replace(/\b(?:i am|im)\b/g,"i'm").replace(/\b(?:you are|youre)\b/g,"you're").replace(/\b(?:we are|were)\b/g,"we're").replace(/\b(?:they are|theyre)\b/g,"they're").replace(/\b(?:she is|shes)\b/g,"she's").replace(/\b(?:he is|hes)\b/g,"he's").replace(/\b(?:it is|its)\b/g,"it's").replace(/(\b[a-z]+)'ll\b/gi,"$1 will").replace(/(\b(?:i|you|he|she|we|they|it))'?d\b/g,"$1 would").replace(/\brecieve\b/g,"receive").replace(/\bdefinately\b/g,"definitely").replace(/\bpractice\b/g,"practise").replace(/\s+/g," ").trim(),S=C([]),G=(t,n)=>{const s=n+1;s<_.value.tasks[t].questions.length&&ue(()=>{const e=S.value.find(u=>Number(u.dataset.task)===t&&Number(u.dataset.question)===s);e==null||e.focus()})},z=(t,n,s,e)=>{if(!g.value[t]||_.value.tasks[t].taskID!=="student_input")return"";const u=y(d.value[t][n]),b=y(s);return u===b?"correct":e!=null&&e.some(p=>y(p)===u)?"almost":"incorrect"},R=(t,n,s,e)=>{if(!g.value[t])return"";if(_.value.tasks[t].taskID==="student_input"){const u=y(d.value[t][n]),b=y(s);return u===b?"student-input-correct":e&&e.some(p=>y(p)===u)?"student-input-almost-correct":"student-input-incorrect"}return d.value[t][n]===s?"student-input-correct":"student-input-incorrect"},j=t=>t.split(/(_{1,4})/),Q=()=>{A.value<_.value.tasks.length-1&&(A.value++,window.scrollTo({top:0,behavior:"smooth"}))},Y=()=>{A.value>0&&(A.value--,window.scrollTo({top:0,behavior:"smooth"}))},B=t=>t===100?{letter:"A+",class:"grade-Aplus"}:t>=85?{letter:"A",class:"grade-A"}:t>=75?{letter:"B+",class:"grade-Bplus"}:t>=60?{letter:"B-",class:"grade-Bminus"}:t>=40?{letter:"C",class:"grade-C"}:t>=20?{letter:"D",class:"grade-D"}:t>=10?{letter:"E",class:"grade-E"}:{letter:"F",class:"grade-F"},H=t=>{L.value=L.value===t?null:t};le(()=>{O.value=K.params.missionName,_.value=ie[O.value]||null,_.value&&(d.value=_.value.tasks.map(t=>t.taskID==="grid_table"?q(t):t.taskID==="drop_down_text"?t.questions.map(n=>{const s=(n.text.match(/\(/g)||[]).length;return Array(s).fill("")}):Array(t.questions.length).fill(null)),V.value=_.value.tasks.map(()=>[]),g.value=_.value.tasks.map(()=>!1),$.value=_.value.tasks.map(()=>null)),J()});const J=()=>{document.addEventListener("contextmenu",t=>{if(t.target.classList.contains("audio-player"))return t.preventDefault(),!1}),document.addEventListener("keydown",t=>{(t.ctrlKey||t.metaKey)&&t.key==="s"&&t.preventDefault()})},N=t=>t?t.split(",").map(n=>{const[s,e]=n.split("-").map(u=>u.trim());return{english:s,russian:e}}):[],X=t=>{g.value[t]=!0;const n=_.value.tasks[t];let s=0;if(n.taskID==="grid_table")s=ee(t);else{let e=0,u=0;n.questions.forEach((b,p)=>{if(n.taskID==="student_input"){const a=y(d.value[t][p]),r=y(b.correctAnswer);(a===r||b.almostCorrectAnswers&&b.almostCorrectAnswers.some(i=>y(i)===a))&&e++,u++}else n.taskID==="drop_down_text"?P(b.text).filter(i=>i.type==="dropdown").forEach((i,h)=>{const m=d.value[t][p][h];i.correctOptions.includes(m)&&e++,u++}):(d.value[t][p]===b.correctAnswer&&e++,u++)}),s=u>0?Math.round(e/u*100):0}$.value[t]=s},M=(t,n,s,e)=>{if(!g.value[t])return"";const u=d.value[t][n];return s===e?u===s?"correct-selected":"correct-not-selected":u===s?"incorrect-selected":""},Z=(t,n,s,e)=>{if(!g.value[t])return"";const u=d.value[t][n];return s===e?u===s?"option-correct-selected":"option-correct-not-selected":u===s?"option-incorrect-selected":""},P=t=>{const n=[];let s=0;const e=/\(([^)]+)\)/g;let u;for(;(u=e.exec(t))!==null;){u.index>s&&n.push({type:"text",text:t.substring(s,u.index)});const p=u[1].split(",").map(a=>{const r=a.trim(),i=r.endsWith("*");return{value:i?r.replace(/\*$/,""):r,isCorrect:i}});n.push({type:"dropdown",options:p,index:n.filter(a=>a.type==="dropdown").length,correctOptions:p.filter(a=>a.isCorrect).map(a=>a.value)}),s=u.index+u[0].length}return s<t.length&&n.push({type:"text",text:t.substring(s)}),n},I=(t,n,s)=>g.value[t]?P(s).filter(p=>p.type==="dropdown").every(p=>{const a=d.value[t][n][p.index];return p.correctOptions.includes(a)})?"correct":"incorrect":"",x=(t,n,s,e)=>{if(!g.value[t])return"";const u=d.value[t][n][s];return e.includes(u)?"drop-down-correct":"drop-down-incorrect"},V=C([]),q=t=>t.tableData.rows.map(n=>{const s={cells:[]};return n.cells.forEach((e,u)=>{s.cells.push(n.editable[u]?"":e)}),s}),ee=t=>{const n=_.value.tasks[t],s=[];n.tableData.rows.forEach((u,b)=>{const p={allCorrect:!0,incorrect:{}};if(!u.correctAnswers){s.push(p);return}u.editable.forEach((a,r)=>{var T;if(!a||u.correctAnswers.cells[r]==="anyIsOk")return;const i=y(d.value[t][b].cells[r]),h=y(u.correctAnswers.cells[r]),m=(T=u.correctAnswers.almostCorrect)==null?void 0:T[r];i!==h&&(!m||!m.some(re=>y(re)===i))&&(p.allCorrect=!1,p.incorrect[r]={correct:u.correctAnswers.cells[r],userAnswer:d.value[t][b].cells[r]})}),s.push(p)}),V.value[t]=s;const e=s.filter(u=>u.allCorrect).length;return Math.round(e/n.tableData.rows.length*100)},te=(t,n,s,e)=>{var a;if(!g.value[t]||!e)return"";if(e.cells[s]==="anyIsOk")return"grid-input-correct";const u=y(d.value[t][n].cells[s]),b=y(e.cells[s]),p=(a=e.almostCorrect)==null?void 0:a[s];return u===b?"grid-input-correct":p&&p.some(r=>y(r)===u)?"grid-input-almost-correct":"grid-input-incorrect"},se=["#cff0ff","#e0c0ff","#ffc0cb","#ffd700","#98fb98","#ffa07a","#ff6347"];return(t,n)=>_.value?(o(),l("div",pe,[c("div",ve,[c("h2",null,v(_.value.mainDescription),1),c("div",he,[n[0]||(n[0]=c("p",{class:"main-description"},"Special tasks for S.P.E.C.i.A.L. agents",-1)),c("div",_e,v(A.value+1)+"/"+v(_.value.tasks.length),1)])]),(o(!0),l(f,null,w(_.value.tasks,(s,e)=>{var u,b,p;return o(),l("div",{key:e,class:"task-container",style:ne({backgroundColor:se[e%7],display:e===A.value?"block":"none"})},[(p=(b=(u=_.value)==null?void 0:u.tasks)==null?void 0:b[e])!=null&&p.usefulWords?(o(),l("div",fe,[c("div",be,[n[2]||(n[2]=c("span",{class:"useful-words-title"},"Useful words:",-1)),c("div",me,[(o(!0),l(f,null,w(N(_.value.tasks[e].usefulWords),(a,r)=>(o(),l("div",{key:r,class:"word-pair"},[c("span",ge,v(a.english),1),n[1]||(n[1]=c("span",{class:"separator"},"-",-1)),c("span",ye,v(a.russian),1),r<N(_.value.tasks[e].usefulWords).length-1?(o(),l("span",we,",")):k("",!0)]))),128))])])])):k("",!0),c("h3",ke,v(s.taskDescription),1),s.taskPicture?(o(),l("div",Ce,[c("img",{src:s.taskPicture,alt:"Image for task "+(e+1),class:"task-image"},null,8,Ae)])):k("",!0),s.audio?(o(),l("audio",De,[c("source",{src:s.audio,type:"audio/mp3"},null,8,Te),n[3]||(n[3]=E(" Your browser does not support the audio element. "))])):k("",!0),s.taskID==="true_false"?(o(),l("div",Ee,[c("table",Ue,[n[4]||(n[4]=c("thead",null,[c("tr",null,[c("th",null,"\u043F\u0440\u0430\u0432\u0434\u0430 / \u0422\u0420\u0423 / \u0438\u043B\u0438 / \u0444\u041E\u043B\u0441 / \u043B\u043E\u0436\u044C :"),c("th",{class:"true-header"},"True"),c("th",{class:"false-header"},"False")])],-1)),c("tbody",null,[(o(!0),l(f,null,w(s.questions,(a,r)=>(o(),l("tr",{key:r},[c("td",null,v(a.text),1),c("td",null,[c("label",$e,[U(c("input",{type:"radio",name:"task"+e+"q"+r,value:"true","onUpdate:modelValue":i=>d.value[e][r]=i},null,8,Le),[[F,d.value[e][r]]]),c("span",{class:D(["radio-custom",M(e,r,"true",a.correctAnswer)])},null,2)])]),c("td",null,[c("label",Pe,[U(c("input",{type:"radio",name:"task"+e+"q"+r,value:"false","onUpdate:modelValue":i=>d.value[e][r]=i},null,8,Ve),[[F,d.value[e][r]]]),c("span",{class:D(["radio-custom",M(e,r,"false",a.correctAnswer)])},null,2)])])]))),128))])])])):s.taskID==="multiple_choice"?(o(),l("div",Fe,[(o(!0),l(f,null,w(s.questions,(a,r)=>(o(),l("div",{key:r,class:"question-container"},[c("p",Oe,v(r+1)+") "+v(a.text),1),c("div",Se,[(o(!0),l(f,null,w(a.options,(i,h)=>(o(),l("label",{key:h,class:D(["option-label",[Z(e,r,h,a.correctAnswer),d.value[e][r]===h&&!g.value[e]?"option-selected":""]])},[U(c("input",{type:"radio",name:"task"+e+"q"+r,value:h,"onUpdate:modelValue":m=>d.value[e][r]=m,class:"option-input"},null,8,ze),[[F,d.value[e][r]]]),c("span",Be,v(h)+" : "+v(i),1)],2))),128))])]))),128))])):s.taskID==="student_input"?(o(),l("div",Ne,[(o(!0),l(f,null,w(s.questions,(a,r)=>(o(),l("div",{key:r,class:"question-container"},[c("p",Me,[(o(!0),l(f,null,w(j(a.text),(i,h)=>(o(),l(f,null,[i.startsWith("_")?U((o(),l("input",{key:0,type:"text",class:D(["student-input",[R(e,r,a.correctAnswer,a.almostCorrectAnswers),{"input-small":i.length===1,"input-medium":i.length===2,"input-large":i.length===3,"input-full":i.length>=4}]]),"onUpdate:modelValue":m=>d.value[e][r]=m,onKeyup:ae(m=>G(e,r),["enter"]),disabled:!1,"data-task":e,"data-question":r,ref_for:!0,ref_key:"inputFields",ref:S},null,42,We)),[[W,d.value[e][r]]]):(o(),l(f,{key:1},[E(v(i),1)],64))],64))),256))]),g.value[e]?(o(),l("div",Ke,[z(e,r,a.correctAnswer,a.almostCorrectAnswers)==="correct"?(o(),l("span",Ge,"\u2713 \u0412\u0435\u0440\u043D\u043E!")):z(e,r,a.correctAnswer,a.almostCorrectAnswers)==="almost"?(o(),l("span",Re,"\u26A0 \u0412\u0440\u043E\u0434\u0435 \u0442\u043E\u0436\u0435 \u043D\u043E\u0440\u043C \u043E\u0442\u0432\u0435\u0442, \u043D\u043E \u0441\u0442\u043E\u0438\u0442 \u043F\u0440\u043E\u0432\u0435\u0440\u0438\u0442\u044C!")):(o(),l("span",je,[n[5]||(n[5]=E(" \u2717 \u041D\u0435\u0432\u0435\u0440\u043D\u043E. \u041F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u044B\u0439 \u043E\u0442\u0432\u0435\u0442: ")),c("strong",null,v(a.correctAnswer),1)]))])):k("",!0)]))),128))])):s.taskID==="drop_down_text"?(o(),l("div",Qe,[(o(!0),l(f,null,w(s.questions,(a,r)=>(o(),l("div",{key:r,class:"question-container"},[c("p",Ye,[(o(!0),l(f,null,w(P(a.text),(i,h)=>(o(),l(f,{key:h},[i.type==="dropdown"?U((o(),l("select",{key:0,class:D(["drop-down-select",x(e,r,i.index,i.correctOptions)]),"onUpdate:modelValue":m=>d.value[e][r][i.index]=m},[n[6]||(n[6]=c("option",{value:"",disabled:"",selected:""},"? ? ?",-1)),(o(!0),l(f,null,w(i.options,(m,T)=>(o(),l("option",{key:T,value:m.value,class:D({"correct-option":m.isCorrect,"selected-option":d.value[e][r][i.index]===m.value})},v(m.value),11,Je))),128))],10,He)),[[ce,d.value[e][r][i.index]]]):(o(),l(f,{key:1},[E(v(i.text),1)],64))],64))),128))]),g.value[e]?(o(),l("div",Xe,[I(e,r,s.questions[r].text)==="correct"?(o(),l("span",Ze,"\u2713 \u0412\u0435\u0440\u043D\u043E!")):(o(),l("span",Ie," \u2717 \u041D\u0435\u0432\u0435\u0440\u043D\u043E. \u0413\u0434\u0435-\u0442\u043E \u043D\u0443\u0436\u043D\u043E \u0438\u0441\u043F\u0440\u0430\u0432\u0438\u0442\u044C! "))])):k("",!0)]))),128))])):s.taskID==="grid_table"?(o(),l("div",xe,[c("table",qe,[c("thead",null,[c("tr",null,[(o(!0),l(f,null,w(s.tableData.headers,(a,r)=>(o(),l("th",{key:r},v(a),1))),128))])]),c("tbody",null,[(o(!0),l(f,null,w(s.tableData.rows,(a,r)=>(o(),l("tr",{key:r},[(o(!0),l(f,null,w(a.cells,(i,h)=>{var m;return o(),l("td",{key:h},[a.editable[h]?U((o(),l("input",{key:0,type:"text",class:D(["grid-table-input",te(e,r,h,a.correctAnswers)]),"onUpdate:modelValue":T=>d.value[e][r].cells[h]=T,placeholder:((m=a.correctAnswers)==null?void 0:m.cells[h])==="anyIsOkay"?"Any answer":""},null,10,et)),[[W,d.value[e][r].cells[h]]]):(o(),l(f,{key:1},[E(v(i),1)],64))])}),128))]))),128))])]),g.value[e]?(o(),l("div",tt,[(o(!0),l(f,null,w(V.value[e],(a,r)=>(o(),l("div",{key:r,class:"feedback-item"},[E(" \u0421\u0442\u0440\u043E\u043A\u0430 "+v(r+1)+": ",1),a.allCorrect?(o(),l("span",st,"\u2713 \u0412\u0441\u0435 \u0432\u0435\u0440\u043D\u043E!")):(o(!0),l(f,{key:1},w(a.incorrect,(i,h)=>(o(),l("span",{key:h,class:"incorrect-feedback"},' \u2717 \u043E\u0436\u0438\u0434\u0430\u043B\u043E\u0441\u044C "'+v(i.correct)+'" ',1))),128))]))),128))])):k("",!0)])):k("",!0),c("div",rt,[c("div",ot,[s.textScript?(o(),l("button",{key:0,class:"toggle-script-btn",onClick:a=>H(e)},v(L.value===e?"\u0421\u043A\u0440\u044B\u0442\u044C \u043F\u043E\u0434\u0441\u043A\u0430\u0437\u043A\u0438":"\u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u043F\u043E\u0434\u0441\u043A\u0430\u0437\u043A\u0438"),9,lt)):k("",!0),c("div",{class:D(["score-display",[{"score-visible":g.value[e]},g.value[e]?B($.value[e]).class:""]])},v(g.value[e]?`${$.value[e]}% (${B($.value[e]).letter})`:""),3),c("button",{class:"check-button",onClick:a=>X(e)}," \u041F\u0440\u043E\u0432\u0435\u0440\u0438\u0442\u044C ",8,nt)]),L.value===e?(o(),l("div",at,[c("p",null,v(s.textScript),1)])):k("",!0),c("div",ct,[c("button",{class:"nav-button prev-button",onClick:Y,disabled:A.value===0}," \u2190 ",8,ut),c("button",{class:"nav-button next-button",onClick:Q,disabled:A.value===_.value.tasks.length-1}," \u2192 ",8,it)])])],4)}),128))])):k("",!0)}};var ft=de(dt,[["__scopeId","data-v-3d77e5bf"]]);export{ft as default};
