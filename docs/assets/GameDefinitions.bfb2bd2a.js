import{u as M,b as f,i as b,B,d as F,o as d,f as h,h as n,t as p,F as N,q as V,l as v,j as K,m as L,n as U,C as j}from"./index.ee6dc8cd.js";import{d as E}from"./definitions-data.71a2b961.js";import{_ as R}from"./plugin-vue_export-helper.21dcd24c.js";const S={key:0,class:"game-container"},q={class:"progress-info"},H={class:"cards-grid"},J={class:"definition-section"},O={class:"english-definition"},P=["onClick"],Q={key:1,class:"translation"},X={class:"input-section"},Y=["onUpdate:modelValue","onKeyup","disabled"],Z=["onClick","disabled"],W={key:0,class:"completion-message"},ee={__name:"GameDefinitions",setup(te){const y=M(),g=f([]),u=f([]),o=f([]),i=f(0),k=b(()=>{const t=Math.max(0,u.value.length-i.value),e=o.value.filter(s=>!s.isCompleted).length;return t+e}),D=b(()=>g.value.length);B(o,t=>{t.filter(s=>s.isCompleted).length>0&&i.value<u.value.length&&I()},{deep:!0});const A=t=>t.replace(/\s*\([^)]*\)/g,""),C=()=>{const t=y.params.missionName;g.value=E[t]||[],u.value=g.value.map(e=>({id:e.id,eng:e.eng,engClean:A(e.eng),ru:e.ru,ans:e.ans,userAnswer:"",showTranslation:!1,isCompleted:!1,isCorrect:!1,isIncorrect:!1})),i.value=0,T()},T=()=>{const t=u.value.slice(i.value,i.value+2);o.value=t.map(e=>({...e,userAnswer:"",showTranslation:!1,isCompleted:!1,isCorrect:!1,isIncorrect:!1})),i.value+=t.length},I=()=>{const t=[...o.value];let e=!1;for(let s=0;s<t.length;s++)if(t[s].isCompleted&&i.value<u.value.length){const a=u.value[i.value];t[s]={...a,userAnswer:"",showTranslation:!1,isCompleted:!1,isCorrect:!1,isIncorrect:!1},i.value++,e=!0}e&&(o.value=t)},x=t=>{o.value[t].showTranslation=!o.value[t].showTranslation},_=t=>{const e=o.value[t];if(!e.userAnswer.trim()||e.isCompleted)return;z(e.userAnswer,e.ans)?(e.isCorrect=!0,e.isIncorrect=!1,setTimeout(()=>{e.isCompleted=!0},800)):(e.isCorrect=!1,e.isIncorrect=!0,setTimeout(()=>{e.isIncorrect=!1},2e3))},G=()=>{C()},w=t=>!t||typeof t!="string"?"":t.toLowerCase().replace(/\s+/g," ").trim().replace(/[.,!?;:…–—]+$/g,"").replace(/[.,!?;:…–—]/g," ").replace(/\s+/g," ").replace(/[`'‘’´]/g,"'").replace(/\bdo not\b/g,"don't").replace(/\bdoes not\b/g,"doesn't").replace(/\bdid not\b/g,"didn't").replace(/\bwill not\b/g,"won't").replace(/\bcan not\b/g,"can't").replace(/\b(?:dont|doesnt|didnt|wont|cant)\b/g,e=>({dont:"don't",doesnt:"doesn't",didnt:"didn't",wont:"won't",cant:"can't"})[e]).replace(/\s+/g," ").trim(),$=(t,e)=>{if(t===e)return!0;const s=["he","his","she","her","you","your","we","our","it","is","are","was","were","do","does","did","have","has","had","who","why"],a=e.length<=3;if(s.includes(e)||a||Math.abs(t.length-e.length)>1)return!1;let c=0;const l=Math.max(t.length,e.length);for(let r=0,m=0;r<l||m<l;r++,m++)if(r>=t.length||m>=e.length||t[r]!==e[m]){if(c++,c>1)return!1;t.length>e.length?m--:t.length<e.length&&r--}return!0},z=(t,e)=>{const s=w(t),a=w(e);if(s===a)return!0;const c=s.split(" "),l=a.split(" ");if(c.length!==l.length)return!1;for(let r=0;r<l.length;r++)if(!$(c[r],l[r]))return!1;return!0};return F(()=>{C()}),(t,e)=>g.value?(d(),h("div",S,[n("div",q,[n("p",null,"\u041E\u0441\u0442\u0430\u043B\u043E\u0441\u044C: "+p(k.value)+" \u0438\u0437 "+p(D.value),1)]),n("div",H,[(d(!0),h(N,null,V(o.value,(s,a)=>{var c;return d(),h("div",{class:"main-card",key:`${s.id}-${a}`},[n("div",J,[e[0]||(e[0]=n("h3",null,"Definition:",-1)),n("p",O,p(s.engClean),1),s.showTranslation?v("",!0):(d(),h("button",{key:0,class:"show-translation-btn",onClick:l=>x(a)}," \u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u043F\u0435\u0440\u0435\u0432\u043E\u0434 ",8,P)),s.showTranslation?(d(),h("div",Q,[n("p",null,p(s.ru),1)])):v("",!0)]),n("div",X,[K(n("input",{class:U(["answer-input",{correct:s.isCorrect,incorrect:s.isIncorrect}]),type:"text","onUpdate:modelValue":l=>s.userAnswer=l,onKeyup:j(l=>_(a),["enter"]),placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u043F\u0435\u0440\u0441\u043E\u043D\u0430\u0436\u0430...",disabled:s.isCompleted},null,42,Y),[[L,s.userAnswer]]),n("button",{class:"check-btn",onClick:l=>_(a),disabled:!((c=s.userAnswer)!=null&&c.trim())||s.isCompleted},p(s.isCompleted?"\u2713":"\u041F\u0440\u043E\u0432\u0435\u0440\u0438\u0442\u044C"),9,Z)])])}),128))]),u.value.length===0&&o.value.length===0?(d(),h("div",W,[e[1]||(e[1]=n("h3",null,"\u{1F389} \u041F\u043E\u0437\u0434\u0440\u0430\u0432\u043B\u044F\u0435\u043C! \u0412\u044B \u043E\u0442\u0433\u0430\u0434\u0430\u043B\u0438 \u0432\u0441\u0435\u0445 \u043F\u0435\u0440\u0441\u043E\u043D\u0430\u0436\u0435\u0439!",-1)),n("button",{class:"restart-btn",onClick:G},"\u041D\u0430\u0447\u0430\u0442\u044C \u0437\u0430\u043D\u043E\u0432\u043E")])):v("",!0)])):v("",!0)}};var le=R(ee,[["__scopeId","data-v-7c8e575e"]]);export{le as default};
