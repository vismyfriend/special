import{u as Ce,r,i as h,o as ke,b as o,c as l,e as n,F as S,t as i,z as be,q as N,l as E,n as J,x as H}from"./index.fb3c059c.js";import{p as K}from"./pnqw.ede1b8a7.js";import{_ as De}from"./plugin-vue_export-helper.21dcd24c.js";const Ne={class:"detective-container"},we={key:0,class:"loading-screen"},Re={key:0,class:"results-screen"},xe={class:"results-stats"},Le={class:"stat correct-stat"},Oe={class:"stat-value"},Me={class:"stat attempts-stat"},Ae={class:"stat-value"},qe={class:"success-rate"},Qe={class:"rate-value"},Ie={key:1},Pe={class:"case-header"},We={class:"secret-text"},Xe={key:0,class:"evidence-note"},Ye={class:"word-grid"},Be={class:"evidence-word"},Ge={class:"evidence-translation"},Ue={class:"case-file"},Ve={class:"case-number"},ze={class:"case-title"},Fe={key:0,class:"evidence-photo"},je=["src"],$e={key:1,class:"case-text"},Je={class:"sentence-types"},He=["onClick"],Ke={class:"sentence-container"},Ze={class:"sentence-label"},et=["onDragover","onDrop"],tt=["onDragstart","onTouchstart","onTouchend"],st={class:"case-controls"},nt=["disabled"],at=["disabled"],ot={__name:"GamePNQW",setup(lt){const A=Ce(),w=r(!0),R=r(null),v=r([]),T=r(0),x=r(!1),y=r(0),L=r(0),u=r("all"),q=r(0),Q=r(0),p=r(null),I=r(-1),O=r(-1),Z=["positive","negative","question","openQuestion"],P={positive:"(+) \u0423\u0422\u0412\u0415\u0420\u0416\u0414\u0415\u041D\u0418\u0415",negative:"(-) \u041E\u0422\u0420\u0418\u0426\u0410\u041D\u0418\u0415",question:"(?) \u0412\u041E\u041F\u0420\u041E\u0421 \u043D\u0430 \u043A\u043E\u0442\u043E\u0440\u044B\u0439 \u043E\u0442\u0432\u0435\u0442 \u0414\u0410 \u0438\u043B\u0438 \u041D\u0415\u0422",openQuestion:"(o?) \u0414\u043E\u043F\u043E\u043B\u043D\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u0439 \u0432\u043E\u043F\u0440\u043E\u0441",all:"All Types"},W=h(()=>v.value.length>0&&v.value.every(e=>e.isCorrect)),g=h(()=>{var e,t;return((t=(e=R.value)==null?void 0:e.tasks)==null?void 0:t[0])||{}}),M=h(()=>{var e;return((e=g.value.questions)==null?void 0:e[T.value])||{}}),C=h(()=>{var e;return((e=g.value.questions)==null?void 0:e.length)||0}),X=h(()=>T.value===C.value-1),ee=h(()=>C.value?Math.round(y.value/C.value*100):0),te=h(()=>{const e=A.params.missionName;return K[e]||{}}),se=h(()=>te.value.mainDescription||"VERY SECRET MISSION");ke(()=>{const e=A.params.missionName;R.value=K[e]||null,R.value?(k(),w.value=!1):(w.value=!1,console.error("Game data not loaded!"))});const k=()=>{const e=[],t=M.value;if(!t)return;const s=(a,c)=>{if(c){const d=me(c);e.push({type:a,original:c,normalizedOriginal:d.join(" "),words:_e(d),isCorrect:!1})}};(u.value==="all"||u.value==="positive")&&s("positive",t.positiveStatement),(u.value==="all"||u.value==="negative")&&s("negative",t.negativeStatement),(u.value==="all"||u.value==="question")&&s("question",t.questionStatement),(u.value==="all"||u.value==="openQuestion")&&s("openQuestion",t.openQuestionStatement),v.value=e},ne=e=>{u.value=e,k()},ae=()=>{T.value++,u.value="all",k()},oe=()=>{T.value=0,x.value=!1,y.value=0,L.value=0,u.value="all",k()},le=()=>{let e=0,t=!1;v.value.forEach(s=>{const a=s.words.join(" ");s.isCorrect=a===s.normalizedOriginal,s.isCorrect?e++:t=!0}),L.value++,t&&document.querySelectorAll(".sentence-row").forEach(s=>{s.classList.contains("correct")||(s.classList.add("incorrect-pulse"),setTimeout(()=>{s.classList.remove("incorrect-pulse"),setTimeout(()=>{s.classList.add("incorrect-pulse"),setTimeout(()=>{s.classList.remove("incorrect-pulse"),setTimeout(()=>{s.classList.add("incorrect-pulse"),setTimeout(()=>s.classList.remove("incorrect-pulse"),100)},300)},300)},300)},300))}),e===v.value.length&&y.value++},ce=()=>{x.value=!0},re=(e,t,s)=>{e.dataTransfer.setData("text/plain",JSON.stringify({sentenceIndex:t,wordIndex:s})),e.target.classList.add("dragging")},ie=e=>{e.preventDefault()},ue=(e,t)=>{e.preventDefault();const s=JSON.parse(e.dataTransfer.getData("text/plain"));Y(s.sentenceIndex,s.wordIndex,t,e)},de=e=>{e.target.classList.remove("dragging")},ve=(e,t,s)=>{const a=e.touches[0];q.value=a.clientX,Q.value=a.clientY,p.value=e.target,I.value=s,O.value=t,p.value.classList.add("dragging")},pe=e=>{if(!p.value)return;e.preventDefault();const t=e.touches[0],s=t.clientX,a=t.clientY;p.value.style.transform=`translate(${s-q.value}px, ${a-Q.value}px)`},he=(e,t)=>{if(!!p.value){if(p.value.classList.remove("dragging"),p.value.style.transform="",O.value===t){const s={clientX:e.changedTouches[0].clientX,currentTarget:e.currentTarget};Y(O.value,I.value,t,s)}p.value=null}},Y=(e,t,s,a)=>{var V,z,F,j;if(e!==s)return;const c=[...v.value],d=[...c[s].words],[m]=d.splice(t,1);let b=d.length;const Te=a.currentTarget,B=Array.from(Te.querySelectorAll(".word-tag"));let D=null,G=1/0;const U=a.clientX||((z=(V=a.changedTouches)==null?void 0:V[0])==null?void 0:z.clientX),Se=a.clientY||((j=(F=a.changedTouches)==null?void 0:F[0])==null?void 0:j.clientY);if(B.forEach(f=>{if(f.classList.contains("dragging"))return;const _=f.getBoundingClientRect(),Ee=_.left+_.width/2,ye=_.top+_.height/2,$=Math.sqrt(Math.pow(U-Ee,2)+Math.pow(Se-ye,2));$<G&&(G=$,D=f)}),D){const f=B.indexOf(D),_=D.getBoundingClientRect();b=U<_.left+_.width/2?f:f+1,b=Math.min(b,d.length)}d.splice(b,0,m),c[s].words=d,v.value=c},ge=e=>e?e.split(",").map(t=>{const[s,a]=t.split("-").map(c=>c.trim());return{english:s,russian:a}}):[],me=e=>e.match(/(\w+['`]\w+|\w+-\w+|\w+|[.,!?])/g)||[],_e=e=>{const t=[...e];for(let s=t.length-1;s>0;s--){const a=Math.floor(Math.random()*(s+1));[t[s],t[a]]=[t[a],t[s]]}return t},fe=e=>P[e]||e;return(e,t)=>(o(),l("div",Ne,[w.value?(o(),l("div",we,t[1]||(t[1]=[n("div",{class:"loading-spinner"},null,-1),n("div",{class:"loading-text"},"DECRYPTING CASE FILES...",-1)]))):(o(),l(S,{key:1},[x.value?(o(),l("div",Re,[t[5]||(t[5]=n("h2",{class:"secret-text"},"MISSION COMPLETE",-1)),n("div",xe,[n("div",Le,[n("span",Oe,i(y.value),1),t[2]||(t[2]=n("span",{class:"stat-label"},"CORRECT ANSWERS",-1))]),n("div",Me,[n("span",Ae,i(L.value),1),t[3]||(t[3]=n("span",{class:"stat-label"},"TOTAL ATTEMPTS",-1))])]),n("div",qe,[t[4]||(t[4]=be(" SUCCESS RATE: ")),n("span",Qe,i(ee.value)+"%",1)]),n("button",{onClick:oe,class:"detective-button restart-btn"}," NEW MISSION ")])):(o(),l("div",Ie,[n("div",Pe,[n("h2",We,i(se.value),1),t[6]||(t[6]=n("p",{class:"case-description"},"code name: WORD ORDER RECONSTRUCTION",-1))]),g.value.usefulWords?(o(),l("div",Xe,[t[8]||(t[8]=n("div",{class:"note-header"},"EVIDENCE // NOTES",-1)),n("div",Ye,[(o(!0),l(S,null,N(ge(g.value.usefulWords),(s,a)=>(o(),l("div",{key:a,class:"word-pair"},[n("span",Be,i(s.english),1),t[7]||(t[7]=n("span",{class:"evidence-separator"},"::",-1)),n("span",Ge,i(s.russian),1)]))),128))])])):E("",!0),n("div",Ue,[n("div",Ve,i(T.value+1)+"/"+i(C.value),1),n("h3",ze,i(g.value.taskDescription||"RECONSTRUCT THE SENTENCES"),1),g.value.taskPicture?(o(),l("div",Fe,[n("img",{src:g.value.taskPicture,class:"case-img"},null,8,je)])):E("",!0),M.value.text?(o(),l("h3",$e,i(M.value.text),1)):E("",!0),n("div",Je,[(o(),l(S,null,N(Z,(s,a)=>n("button",{key:a,onClick:c=>ne(s),class:J([{active:u.value===s},"type-tab"])},i(P[s]),11,He)),64))]),n("div",Ke,[(o(!0),l(S,null,N(v.value,(s,a)=>(o(),l("div",{key:a,class:J(["sentence-row",{correct:s.isCorrect}])},[n("div",Ze,i(fe(s.type))+":",1),n("div",{class:"word-bank",onDragover:H(c=>ie(c),["prevent"]),onDrop:c=>ue(c,a),onTouchmove:t[0]||(t[0]=H(()=>{},["prevent"]))},[(o(!0),l(S,null,N(s.words,(c,d)=>(o(),l("div",{key:d,class:"word-tag",draggable:"true",onDragstart:m=>re(m,a,d),onDragend:de,onTouchstart:m=>ve(m,a,d),onTouchend:m=>he(m,a),onTouchmove:pe},i(c),41,tt))),128))],40,et)],2))),128))]),n("div",st,[n("button",{onClick:le,class:"detective-button verify-btn"}," is this correct? "),X.value?E("",!0):(o(),l("button",{key:0,onClick:ae,class:"detective-button next-btn",disabled:!W.value}," Super ! NEXT ",8,nt)),X.value?(o(),l("button",{key:1,onClick:ce,class:"detective-button finish-btn",disabled:!W.value}," SUBMIT CASE ",8,at)):E("",!0)])])]))],64))]))}};var ut=De(ot,[["__scopeId","data-v-67da4494"]]);export{ut as default};
