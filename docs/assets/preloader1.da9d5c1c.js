import{_ as l}from"./plugin-vue_export-helper.21dcd24c.js";import{o as h,f as m,h as s,t as o,l as u}from"./index.c0eaa48e.js";const d={name:"DetectivePreloader",props:{autoHide:{type:Boolean,default:!0},minDisplayTime:{type:Number,default:4e3},immediateHide:{type:Boolean,default:!1}},data(){return{currentPercentage:2.12,currentPhrase:"INVESTIGATING",isVisible:!0,progressStages:[[2.12,12.12,2e3],[12.12,22.98,3e3],[22.98,40.14,2e3],[40.14,68.77,2e3],[68.77,98.89,4500],[98.89,99.98,3e3]],phrases:["HELLO FROM AGENT V.","YOU ARE SPECIAL","YOU ARE NOT LAZYL","WELCOME","TODAY IS A GOOD DAY","YOUR TEACHER LIKES YOU","HOMEWORK ? Goodbye...","HOW IS YOUR DAY?","ALCO-COCA-COLICK","FALLOUT IS AWESOME","IS SHREK A MUTANT?","SECURITY CHECK"],currentStage:0,animationStartTime:null,animationFrame:null,startTimestamp:null}},mounted(){this.startTimestamp=Date.now(),this.setCurrentPhrase(),this.startPercentageAnimation()},beforeUnmount(){this.cleanup()},methods:{cleanup(){this.animationFrame&&(cancelAnimationFrame(this.animationFrame),this.animationFrame=null)},async hide(){if(this.immediateHide){this.isVisible=!1,this.cleanup();return}const e=Date.now()-this.startTimestamp,t=Math.max(0,this.minDisplayTime-e);return t>0&&await new Promise(a=>setTimeout(a,t)),this.isVisible=!1,this.cleanup(),new Promise(a=>setTimeout(a,500))},complete(){this.currentPercentage=99.98,this.cleanup(),this.autoHide&&setTimeout(()=>this.hide(),500)},show(){this.isVisible=!0,this.resetAnimation()},setCurrentPhrase(){const e=this.getVisitData(),t=this.calculatePhraseIndex(e.visitCount);this.currentPhrase=this.phrases[t],this.updateVisitData(e,t)},getVisitData(){const e={visitCount:0,lastPhraseIndex:-1,usedPhrases:[]};try{const t=localStorage.getItem("detective_preloader_visits");return t?JSON.parse(t):e}catch{return e}},calculatePhraseIndex(e){return e<this.phrases.length?e:Math.floor(Math.random()*this.phrases.length)},updateVisitData(e,t){const a={visitCount:e.visitCount+1,lastPhraseIndex:t,lastVisit:new Date().toISOString(),usedPhrases:[...e.usedPhrases,t].slice(-20)};try{localStorage.setItem("detective_preloader_visits",JSON.stringify(a))}catch(r){console.warn("\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0441\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C \u0434\u0430\u043D\u043D\u044B\u0435 \u043E \u043F\u043E\u0441\u0435\u0449\u0435\u043D\u0438\u0438:",r)}},startPercentageAnimation(){this.animationStartTime=performance.now(),this.animatePercentage()},animatePercentage(){const e=performance.now(),t=e-this.animationStartTime;if(this.currentStage<this.progressStages.length){const[a,r,i]=this.progressStages[this.currentStage],n=Math.min(t/i,1),c=this.easeInOutCubic(n);this.currentPercentage=Number((a+(r-a)*c).toFixed(2)),n<1?this.animationFrame=requestAnimationFrame(this.animatePercentage):(this.currentStage++,this.animationStartTime=e,this.animationFrame=requestAnimationFrame(this.animatePercentage))}else this.currentPercentage=99.98,this.autoHide&&setTimeout(()=>this.hide(),1e3)},easeInOutCubic(e){return e<.5?4*e*e*e:1-Math.pow(-2*e+2,3)/2},resetAnimation(){this.cleanup(),this.currentPercentage=2.12,this.currentStage=0,this.animationStartTime=null,this.startTimestamp=Date.now(),this.startPercentageAnimation()},addNewPhrase(e){this.phrases.includes(e.toUpperCase())||this.phrases.push(e.toUpperCase())},getVisitStats(){return this.getVisitData()},resetVisitHistory(){try{localStorage.removeItem("detective_preloader_visits"),console.log("\u0418\u0441\u0442\u043E\u0440\u0438\u044F \u043F\u043E\u0441\u0435\u0449\u0435\u043D\u0438\u0439 \u0441\u0431\u0440\u043E\u0448\u0435\u043D\u0430")}catch(e){console.warn("\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0441\u0431\u0440\u043E\u0441\u0438\u0442\u044C \u0438\u0441\u0442\u043E\u0440\u0438\u044E:",e)}}}},p={key:0,class:"detective-preloader"},g={class:"loading-text"},S={class:"text"},f={class:"percentage-display"};function P(e,t,a,r,i,n){return i.isVisible?(h(),m("div",p,[t[1]||(t[1]=s("div",{class:"magnifying-glass"},[s("div",{class:"glass"},[s("div",{class:"glass-inner"})]),s("div",{class:"handle"})],-1)),s("div",g,[s("span",S,o(i.currentPhrase),1),t[0]||(t[0]=s("span",{class:"dots"},[s("span",{class:"dot"},"."),s("span",{class:"dot"},"."),s("span",{class:"dot"},".")],-1))]),s("div",f," loading "+o(i.currentPercentage)+"% \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0430 ",1),t[2]||(t[2]=s("div",{class:"cursor-helper"},null,-1))])):u("",!0)}var T=l(d,[["render",P],["__scopeId","data-v-0709abc3"]]);export{T as default};
