import{u as ne,r as k,o as ae,b as l,c as n,e as u,t as h,F as f,q as w,j as A,s as ce,y as E,w as U,B as S,n as D,k as G,C as ue,D as ie,E as de}from"./index.09dd17b8.js";import{L as pe}from"./ListeningExerciseData.459b2193.js";import{_ as ve}from"./plugin-vue_export-helper.21dcd24c.js";const he={key:0,class:"exercise-container"},_e={class:"exercise-header"},fe={class:"header-bottom"},be={class:"task-counter"},me={key:0,class:"useful-words-container"},ge={class:"useful-words"},ye={class:"useful-words-content"},we={class:"english-word"},ke={class:"translation"},Ae={key:0,class:"comma"},Ce={class:"task-title"},De={key:1,class:"task-image-container"},Te=["src","alt"],Ee={key:2,controls:"",class:"audio-player",controlsList:"nodownload",oncontextmenu:"return false;"},Ue=["src"],$e={key:3,class:"true-false-container"},Le={class:"true-false-table"},Pe={class:"radio-label"},Ve=["name","onUpdate:modelValue"],Se={class:"radio-label"},Fe=["name","onUpdate:modelValue"],Oe={key:4,class:"multiple-choice-container"},ze={class:"question-text"},Be={class:"options-container"},Ne=["name","value","onUpdate:modelValue"],Me={class:"option-text"},We={key:5,class:"student-input-container"},Ge={class:"question-text"},Ke=["onUpdate:modelValue","onKeyup","data-task","data-question"],Re={key:0,class:"answer-feedback"},je={key:0,class:"correct-answer"},Qe={key:1,class:"almost-answer"},Ye={key:2,class:"incorrect-answer"},He={key:6,class:"drop-down-text-container"},Ie={class:"question-text"},Je=["onUpdate:modelValue"],Xe=["value"],Ze={key:0,class:"answer-feedback"},xe={key:0,class:"correct-answer"},qe={key:1,class:"incorrect-answer"},et={key:7,class:"grid-table-container"},tt={class:"grid-table"},st=["onUpdate:modelValue","placeholder"],rt={key:0,class:"grid-table-feedback"},ot={key:0,class:"correct-feedback"},lt={class:"task-footer"},nt={class:"task-controls"},at=["onClick"],ct=["onClick"],ut={key:0,class:"text-script-content"},it={class:"task-navigation"},dt=["disabled"],pt=["disabled"],vt={__name:"ListeningExercise",setup(ht){const K=ne(),p=k(null),d=k([]),g=k([]),L=k(null),$=k([]),F=k(""),C=k(0),y=e=>!e||typeof e!="string"?"":e.toLowerCase().replace(/\s+/g," ").trim().replace(/[.,!?;:…–—]+$/g,"").replace(/[.,!?;:…–—]/g," ").replace(/\s+/g," ").replace(/[`'‘’´]/g,"'").replace(/(\b(?:he|she|it))'?s not\b/g,"$1 is not").replace(/(\b(?:he|she|it)) isn'?t\b/g,"$1 is not").replace(/(\b(?:you|we|they|i))'?re not\b/g,"$1 are not").replace(/(\b(?:you|we|they|i)) aren'?t\b/g,"$1 are not").replace(/\bi'?m not\b/g,"i am not").replace(/\bdo not\b/g,"don't").replace(/\bdoes not\b/g,"doesn't").replace(/\bdid not\b/g,"didn't").replace(/\bwill not\b/g,"won't").replace(/\bcan not\b/g,"can't").replace(/\bmust not\b/g,"mustn't").replace(/\bshould not\b/g,"should't").replace(/\bwould not\b/g,"wouldn't").replace(/\b(?:dont|doesnt|didnt|wont|cant|hadnt|hasnt|mustnt|shouldnt|wouldnt)\b/g,a=>({dont:"don't",doesnt:"doesn't",didnt:"didn't",wont:"won't",cant:"can't",hasnt:"hasn't",hadnt:"hadn't",mustnt:"mustn't",shouldnt:"shouldn't",wouldnt:"wouldn't"})[a]).replace(/\b(?:i am|im)\b/g,"i'm").replace(/\b(?:you are|youre)\b/g,"you're").replace(/\b(?:we are|were)\b/g,"we're").replace(/\b(?:they are|theyre)\b/g,"they're").replace(/\b(?:she is|shes)\b/g,"she's").replace(/\b(?:he is|hes)\b/g,"he's").replace(/\b(?:it is|its)\b/g,"it's").replace(/(\b[a-z]+)'ll\b/gi,"$1 will").replace(/(\b(?:i|you|he|she|we|they|it))'?d\b/g,"$1 would").replace(/\brecieve\b/g,"receive").replace(/\bdefinately\b/g,"definitely").replace(/\bpractice\b/g,"practise").replace(/\s+/g," ").trim(),O=k([]),R=(e,a)=>{const s=a+1;s<p.value.tasks[e].questions.length&&de(()=>{const t=O.value.find(c=>Number(c.dataset.task)===e&&Number(c.dataset.question)===s);t==null||t.focus()})},z=(e,a,s,t)=>{if(!g.value[e]||p.value.tasks[e].taskID!=="student_input")return"";const c=y(d.value[e][a]),b=y(s);return c===b?"correct":t!=null&&t.some(v=>y(v)===c)?"almost":"incorrect"},j=(e,a,s,t)=>{if(!g.value[e])return"";if(p.value.tasks[e].taskID==="student_input"){const c=y(d.value[e][a]),b=y(s);return c===b?"student-input-correct":t&&t.some(v=>y(v)===c)?"student-input-almost-correct":"student-input-incorrect"}return d.value[e][a]===s?"student-input-correct":"student-input-incorrect"},Q=e=>e.split(/(_{1,4})/),Y=()=>{C.value<p.value.tasks.length-1&&(C.value++,window.scrollTo({top:0,behavior:"smooth"}))},H=()=>{C.value>0&&(C.value--,window.scrollTo({top:0,behavior:"smooth"}))},B=e=>e===100?{letter:"A+",class:"grade-Aplus"}:e>=85?{letter:"A",class:"grade-A"}:e>=75?{letter:"B+",class:"grade-Bplus"}:e>=60?{letter:"B-",class:"grade-Bminus"}:e>=40?{letter:"C",class:"grade-C"}:e>=20?{letter:"D",class:"grade-D"}:e>=10?{letter:"E",class:"grade-E"}:{letter:"F",class:"grade-F"},I=e=>{L.value=L.value===e?null:e},J=k([]),X=k([]);ae(()=>{F.value=K.params.missionName,p.value=pe[F.value]||null,p.value&&(d.value=p.value.tasks.map(e=>e.taskID==="grid_table"?te(e):e.taskID==="drop_down_text"?e.questions.map(a=>{const s=(a.text.match(/\(/g)||[]).length;return Array(s).fill("")}):Array(e.questions.length).fill(null)),V.value=p.value.tasks.map(()=>[]),g.value=p.value.tasks.map(()=>!1),$.value=p.value.tasks.map(()=>null),p.value&&(J.value=p.value.tasks.map(e=>e.taskID==="student_input"?!1:null),X.value=p.value.tasks.map(e=>e.taskID==="grid_table"?!1:null))),Z()});const Z=()=>{document.addEventListener("contextmenu",e=>{if(e.target.classList.contains("audio-player"))return e.preventDefault(),!1}),document.addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&e.key==="s"&&e.preventDefault()})},N=e=>e?e.split(",").map(a=>{const[s,t]=a.split("-").map(c=>c.trim());return{english:s,russian:t}}):[],x=e=>{g.value[e]=!0;const a=p.value.tasks[e];let s=0;if(a.taskID==="grid_table")s=se(e);else{let t=0,c=0;a.questions.forEach((b,v)=>{if(a.taskID==="student_input"){const o=y(d.value[e][v]),r=y(b.correctAnswer);(o===r||b.almostCorrectAnswers&&b.almostCorrectAnswers.some(i=>y(i)===o))&&t++,c++}else a.taskID==="drop_down_text"?P(b.text).filter(i=>i.type==="dropdown").forEach((i,_)=>{const m=d.value[e][v][_];i.correctOptions.includes(m)&&t++,c++}):(d.value[e][v]===b.correctAnswer&&t++,c++)}),s=c>0?Math.round(t/c*100):0}$.value[e]=s},M=(e,a,s,t)=>{if(!g.value[e])return"";const c=d.value[e][a];return s===t?c===s?"correct-selected":"correct-not-selected":c===s?"incorrect-selected":""},q=(e,a,s,t)=>{if(!g.value[e])return"";const c=d.value[e][a];return s===t?c===s?"option-correct-selected":"option-correct-not-selected":c===s?"option-incorrect-selected":""},P=e=>{const a=[];let s=0;const t=/\(([^)]+)\)/g;let c;for(;(c=t.exec(e))!==null;){c.index>s&&a.push({type:"text",text:e.substring(s,c.index)});const v=c[1].split(",").map(o=>{const r=o.trim(),i=r.endsWith("*");return{value:i?r.replace(/\*$/,""):r,isCorrect:i}});a.push({type:"dropdown",options:v,index:a.filter(o=>o.type==="dropdown").length,correctOptions:v.filter(o=>o.isCorrect).map(o=>o.value)}),s=c.index+c[0].length}return s<e.length&&a.push({type:"text",text:e.substring(s)}),a},W=(e,a,s)=>{if(!g.value[e])return"";const c=P(s).filter(o=>o.type==="dropdown");return c.every(o=>d.value[e][a][o.index]!=="")?c.every(o=>{const r=d.value[e][a][o.index];return o.correctOptions.includes(r)})?"correct":"incorrect":""},ee=(e,a,s,t)=>{if(!g.value[e])return"";const c=d.value[e][a][s];return c===""?"":t.includes(c)?"drop-down-correct":"drop-down-incorrect"},V=k([]),te=e=>e.tableData.rows.map(a=>{const s={cells:[]};return a.cells.forEach((t,c)=>{s.cells.push(a.editable[c]?"":t)}),s}),se=e=>{const a=p.value.tasks[e],s=[];a.tableData.rows.forEach((c,b)=>{const v={allCorrect:!0,incorrect:{}};if(!c.correctAnswers){s.push(v);return}c.editable.forEach((o,r)=>{var T;if(!o||c.correctAnswers.cells[r]==="anyIsOk")return;const i=y(d.value[e][b].cells[r]),_=y(c.correctAnswers.cells[r]),m=(T=c.correctAnswers.almostCorrect)==null?void 0:T[r];i!==_&&(!m||!m.some(le=>y(le)===i))&&(v.allCorrect=!1,v.incorrect[r]={correct:c.correctAnswers.cells[r],userAnswer:d.value[e][b].cells[r]})}),s.push(v)}),V.value[e]=s;const t=s.filter(c=>c.allCorrect).length;return Math.round(t/a.tableData.rows.length*100)},re=(e,a,s,t)=>{var o;if(!g.value[e]||!t)return"";if(t.cells[s]==="anyIsOk")return"grid-input-correct";const c=y(d.value[e][a].cells[s]),b=y(t.cells[s]),v=(o=t.almostCorrect)==null?void 0:o[s];return c===b?"grid-input-correct":v&&v.some(r=>y(r)===c)?"grid-input-almost-correct":"grid-input-incorrect"},oe=["#cff0ff","#e0c0ff","#ffc0cb","#ffd700","#98fb98","#ffa07a","#ff6347"];return(e,a)=>p.value?(l(),n("div",he,[u("div",_e,[u("h2",null,h(p.value.mainDescription),1),u("div",fe,[a[0]||(a[0]=u("p",{class:"main-description"},"Special tasks for S.P.E.C.i.A.L. agents",-1)),u("div",be,h(C.value+1)+"/"+h(p.value.tasks.length),1)])]),(l(!0),n(f,null,w(p.value.tasks,(s,t)=>{var c,b,v;return l(),n("div",{key:t,class:"task-container",style:ce({backgroundColor:oe[t%7],display:t===C.value?"block":"none"})},[(v=(b=(c=p.value)==null?void 0:c.tasks)==null?void 0:b[t])!=null&&v.usefulWords?(l(),n("div",me,[u("div",ge,[a[2]||(a[2]=u("span",{class:"useful-words-title"},"Useful words:",-1)),u("div",ye,[(l(!0),n(f,null,w(N(p.value.tasks[t].usefulWords),(o,r)=>(l(),n("div",{key:r,class:"word-pair"},[u("span",we,h(o.english),1),a[1]||(a[1]=u("span",{class:"separator"},"-",-1)),u("span",ke,h(o.russian),1),r<N(p.value.tasks[t].usefulWords).length-1?(l(),n("span",Ae,",")):A("",!0)]))),128))])])])):A("",!0),u("h3",Ce,h(s.taskDescription),1),s.taskPicture?(l(),n("div",De,[u("img",{src:s.taskPicture,alt:"Image for task "+(t+1),class:"task-image"},null,8,Te)])):A("",!0),s.audio?(l(),n("audio",Ee,[u("source",{src:s.audio,type:"audio/mp3"},null,8,Ue),a[3]||(a[3]=E(" Your browser does not support the audio element. "))])):A("",!0),s.taskID==="true_false"?(l(),n("div",$e,[u("table",Le,[a[4]||(a[4]=u("thead",null,[u("tr",null,[u("th",null,"\u043F\u0440\u0430\u0432\u0434\u0430 / \u0422\u0420\u0423 / \u0438\u043B\u0438 / \u0444\u041E\u043B\u0441 / \u043B\u043E\u0436\u044C :"),u("th",{class:"true-header"},"True"),u("th",{class:"false-header"},"False")])],-1)),u("tbody",null,[(l(!0),n(f,null,w(s.questions,(o,r)=>(l(),n("tr",{key:r},[u("td",null,h(o.text),1),u("td",null,[u("label",Pe,[U(u("input",{type:"radio",name:"task"+t+"q"+r,value:"true","onUpdate:modelValue":i=>d.value[t][r]=i},null,8,Ve),[[S,d.value[t][r]]]),u("span",{class:D(["radio-custom",M(t,r,"true",o.correctAnswer)])},null,2)])]),u("td",null,[u("label",Se,[U(u("input",{type:"radio",name:"task"+t+"q"+r,value:"false","onUpdate:modelValue":i=>d.value[t][r]=i},null,8,Fe),[[S,d.value[t][r]]]),u("span",{class:D(["radio-custom",M(t,r,"false",o.correctAnswer)])},null,2)])])]))),128))])])])):s.taskID==="multiple_choice"?(l(),n("div",Oe,[(l(!0),n(f,null,w(s.questions,(o,r)=>(l(),n("div",{key:r,class:"question-container"},[u("p",ze,h(r+1)+") "+h(o.text),1),u("div",Be,[(l(!0),n(f,null,w(o.options,(i,_)=>(l(),n("label",{key:_,class:D(["option-label",[q(t,r,_,o.correctAnswer),d.value[t][r]===_&&!g.value[t]?"option-selected":""]])},[U(u("input",{type:"radio",name:"task"+t+"q"+r,value:_,"onUpdate:modelValue":m=>d.value[t][r]=m,class:"option-input"},null,8,Ne),[[S,d.value[t][r]]]),u("span",Me,h(_)+" : "+h(i),1)],2))),128))])]))),128))])):s.taskID==="student_input"?(l(),n("div",We,[(l(!0),n(f,null,w(s.questions,(o,r)=>(l(),n("div",{key:r,class:"question-container"},[u("p",Ge,[(l(!0),n(f,null,w(Q(o.text),(i,_)=>(l(),n(f,null,[i.startsWith("_")?U((l(),n("input",{key:0,type:"text",class:D(["student-input",[j(t,r,o.correctAnswer,o.almostCorrectAnswers),{"input-small":i.length===1,"input-medium":i.length===2,"input-large":i.length===3,"input-full":i.length>=4}]]),"onUpdate:modelValue":m=>d.value[t][r]=m,onKeyup:ue(m=>R(t,r),["enter"]),disabled:!1,"data-task":t,"data-question":r,ref_for:!0,ref_key:"inputFields",ref:O},null,42,Ke)),[[G,d.value[t][r]]]):(l(),n(f,{key:1},[E(h(i),1)],64))],64))),256))]),g.value[t]?(l(),n("div",Re,[z(t,r,o.correctAnswer,o.almostCorrectAnswers)==="correct"?(l(),n("span",je,"\u2713 \u0412\u0435\u0440\u043D\u043E!")):z(t,r,o.correctAnswer,o.almostCorrectAnswers)==="almost"?(l(),n("span",Qe,"\u26A0 \u0412\u0440\u043E\u0434\u0435 \u0442\u043E\u0436\u0435 \u043D\u043E\u0440\u043C \u043E\u0442\u0432\u0435\u0442, \u043D\u043E \u0441\u0442\u043E\u0438\u0442 \u043F\u0440\u043E\u0432\u0435\u0440\u0438\u0442\u044C!")):(l(),n("span",Ye,[a[5]||(a[5]=E(" \u2717 \u041D\u0435\u0432\u0435\u0440\u043D\u043E. \u041F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u044B\u0439 \u043E\u0442\u0432\u0435\u0442: ")),u("strong",null,h(o.correctAnswer),1)]))])):A("",!0)]))),128))])):s.taskID==="drop_down_text"?(l(),n("div",He,[(l(!0),n(f,null,w(s.questions,(o,r)=>(l(),n("div",{key:r,class:"question-container"},[u("p",Ie,[(l(!0),n(f,null,w(P(o.text),(i,_)=>(l(),n(f,{key:_},[i.type==="dropdown"?U((l(),n("select",{key:0,class:D(["drop-down-select",ee(t,r,i.index,i.correctOptions)]),"onUpdate:modelValue":m=>d.value[t][r][i.index]=m},[a[6]||(a[6]=u("option",{value:"",disabled:"",selected:""},"? ? ?",-1)),(l(!0),n(f,null,w(i.options,(m,T)=>(l(),n("option",{key:T,value:m.value},h(m.value),9,Xe))),128))],10,Je)),[[ie,d.value[t][r][i.index]]]):(l(),n(f,{key:1},[E(h(i.text),1)],64))],64))),128))]),g.value[t]&&W(t,r,s.questions[r].text)!==""?(l(),n("div",Ze,[W(t,r,s.questions[r].text)==="correct"?(l(),n("span",xe,"\u2713 \u0412\u0435\u0440\u043D\u043E!")):(l(),n("span",qe," \u2717 \u041D\u0435\u0432\u0435\u0440\u043D\u043E. \u0413\u0434\u0435-\u0442\u043E \u043D\u0443\u0436\u043D\u043E \u0438\u0441\u043F\u0440\u0430\u0432\u0438\u0442\u044C! "))])):A("",!0)]))),128))])):s.taskID==="grid_table"?(l(),n("div",et,[u("table",tt,[u("thead",null,[u("tr",null,[(l(!0),n(f,null,w(s.tableData.headers,(o,r)=>(l(),n("th",{key:r},h(o),1))),128))])]),u("tbody",null,[(l(!0),n(f,null,w(s.tableData.rows,(o,r)=>(l(),n("tr",{key:r},[(l(!0),n(f,null,w(o.cells,(i,_)=>{var m;return l(),n("td",{key:_},[o.editable[_]?U((l(),n("input",{key:0,type:"text",class:D(["grid-table-input",re(t,r,_,o.correctAnswers)]),"onUpdate:modelValue":T=>d.value[t][r].cells[_]=T,placeholder:((m=o.correctAnswers)==null?void 0:m.cells[_])==="anyIsOkay"?"Any answer":""},null,10,st)),[[G,d.value[t][r].cells[_]]]):(l(),n(f,{key:1},[E(h(i),1)],64))])}),128))]))),128))])]),g.value[t]?(l(),n("div",rt,[(l(!0),n(f,null,w(V.value[t],(o,r)=>(l(),n("div",{key:r,class:"feedback-item"},[E(" \u0421\u0442\u0440\u043E\u043A\u0430 "+h(r+1)+": ",1),o.allCorrect?(l(),n("span",ot,"\u2713 \u0412\u0441\u0435 \u0432\u0435\u0440\u043D\u043E!")):(l(!0),n(f,{key:1},w(o.incorrect,(i,_)=>(l(),n("span",{key:_,class:"incorrect-feedback"},' \u2717 \u043E\u0436\u0438\u0434\u0430\u043B\u043E\u0441\u044C "'+h(i.correct)+'" ',1))),128))]))),128))])):A("",!0)])):A("",!0),u("div",lt,[u("div",nt,[s.textScript?(l(),n("button",{key:0,class:"toggle-script-btn",onClick:o=>I(t)},h(L.value===t?"\u0421\u043A\u0440\u044B\u0442\u044C \u043F\u043E\u0434\u0441\u043A\u0430\u0437\u043A\u0438":"\u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u043F\u043E\u0434\u0441\u043A\u0430\u0437\u043A\u0438"),9,at)):A("",!0),u("div",{class:D(["score-display",[{"score-visible":g.value[t]},g.value[t]?B($.value[t]).class:""]])},h(g.value[t]?`${$.value[t]}% (${B($.value[t]).letter})`:""),3),u("button",{class:"check-button",onClick:o=>x(t)}," \u041F\u0440\u043E\u0432\u0435\u0440\u0438\u0442\u044C ",8,ct)]),L.value===t?(l(),n("div",ut,[u("p",null,h(s.textScript),1)])):A("",!0),u("div",it,[u("button",{class:"nav-button prev-button",onClick:H,disabled:C.value===0}," \u2190 ",8,dt),u("button",{class:"nav-button next-button",onClick:Y,disabled:C.value===p.value.tasks.length-1}," \u2192 ",8,pt)])])],4)}),128))])):A("",!0)}};var mt=ve(vt,[["__scopeId","data-v-1d055e82"]]);export{mt as default};
