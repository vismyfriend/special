import{S as p}from"./sortable.esm.65a421f9.js";import{u as f,p as b,o as a,f as l,h as e,t as u,F as m,q as d,l as h,n as v,z as G}from"./index.1d66702d.js";import{s as _}from"./sortingWordsData.b6121869.js";import{_ as C}from"./plugin-vue_export-helper.21dcd24c.js";const k={name:"GameDragAndSorting",setup(){const s=f(),t=b();return{route:s,router:t}},data(){return{sortableInstances:[],currentGameData:{title:"",instructions:"",columns:[],items:[]},currentWords:[],columnAssignments:{},completedItems:new Set,columnRefs:{},gamePhase:"playing",showHints:!1,gameResults:null}},computed:{availableWords(){return this.currentWords.filter(s=>!this.columnAssignments[s.id])},allWordsPlaced(){return this.currentWords.length>0&&this.currentWords.every(s=>this.columnAssignments[s.id])},buttonText(){return"\u2705 \u041F\u0440\u043E\u0432\u0435\u0440\u0438\u0442\u044C"},buttonClass(){return this.allWordsPlaced?"check":"disabled"},percentage(){return Math.round(this.completedItems.size/this.currentGameData.items.length*100)}},mounted(){this.initializeGame()},methods:{initializeGame(){const s=this.route.params.missionName;this.currentGameData=_[s]||_.fruitsVegetables,this.currentWords=[...this.currentGameData.items],this.columnAssignments={},this.completedItems=new Set,this.columnRefs={},this.gamePhase="playing",this.showHints=!1,this.gameResults=null,this.$nextTick(()=>{this.initializeSortable()})},initializeSortable(){if(this.sortableInstances.forEach(s=>s.destroy()),this.sortableInstances=[],this.$refs.wordsContainer){const s=new p(this.$refs.wordsContainer,{group:{name:"words",pull:!0,put:!0},sort:!1,animation:150,onAdd:t=>{const r=t.item.getAttribute("data-id");delete this.columnAssignments[r]}});this.sortableInstances.push(s)}this.currentGameData.columns.forEach(s=>{const t=this.columnRefs[s.id];if(t){const r=new p(t,{group:{name:"words",pull:!0,put:!0},animation:150,onAdd:g=>{const i=g.item.getAttribute("data-id");this.columnAssignments[i]=s.id}});this.sortableInstances.push(r)}})},getItemsInColumn(s){return this.currentWords.filter(t=>this.columnAssignments[t.id]===s)},toggleHints(){this.showHints=!this.showHints},checkAnswers(){if(!this.allWordsPlaced)return;let s=0;const t=new Set;this.currentWords.forEach(r=>{this.columnAssignments[r.id]===r.correctColumn&&(s++,t.add(r.id))}),t.forEach(r=>this.completedItems.add(r)),this.gameResults={missionName:this.route.params.missionName,gameTitle:this.currentGameData.title,totalWords:this.currentGameData.items.length,correctAnswers:s,percentage:Math.round(s/this.currentGameData.items.length*100),timestamp:new Date().toISOString(),items:this.currentWords.map(r=>({id:r.id,eng:r.eng,ru:r.ru,userColumn:this.columnAssignments[r.id],correctColumn:r.correctColumn,isCorrect:this.columnAssignments[r.id]===r.correctColumn}))},s===this.currentWords.length?setTimeout(()=>{this.gamePhase="completed",this.sendGameResults()},1e3):alert(`\u041F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u043E: ${s} \u0438\u0437 ${this.currentWords.length}. \u041F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435!`)},sendGameResults(){console.log("\u{1F4CA} \u0420\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442\u044B \u0438\u0433\u0440\u044B:",this.gameResults)},goToResults(){this.$router.push({name:"GameResults",query:{game:"drag-and-sort",mission:this.route.params.missionName,results:JSON.stringify(this.gameResults)}})},resetGame(){this.initializeGame()}},beforeUnmount(){this.sortableInstances.forEach(s=>s.destroy())}},A={class:"drag-sort-game"},w={class:"game-header"},y={class:"progress-info"},I={class:"instructions"},D={key:0,class:"hints-container"},W={class:"hints-list"},R={class:"eng-word"},S={class:"ru-word"},z={key:1,ref:"wordsContainer",class:"words-container"},P=["data-id"],H={key:2,class:"columns-container"},N={class:"column-header"},T=["data-id"],x={key:3,class:"completion-screen"},E={class:"completion-content"},V={class:"completion-stats"},B={class:"completion-buttons"},q={key:4,class:"game-controls"},F=["disabled"];function M(s,t,r,g,i,o){return a(),l("div",A,[e("div",w,[e("h2",null,u(i.currentGameData.title),1),e("div",y,u(i.completedItems.size)+" / "+u(i.currentGameData.items.length),1)]),e("div",I,[e("p",null,u(i.currentGameData.instructions),1)]),i.showHints?(a(),l("div",D,[t[6]||(t[6]=e("div",{class:"hints-title"},"\u{1F4DA} \u041F\u043E\u0434\u0441\u043A\u0430\u0437\u043A\u0438:",-1)),e("div",W,[(a(!0),l(m,null,d(i.currentWords,n=>(a(),l("div",{key:n.id,class:"hint-item"},[e("span",R,u(n.eng),1),t[5]||(t[5]=G(" - ")),e("span",S,u(n.ru),1)]))),128))])])):h("",!0),i.gamePhase!=="completed"?(a(),l("div",z,[(a(!0),l(m,null,d(o.availableWords,n=>(a(),l("div",{key:n.id,class:"word-card","data-id":n.id},u(n.eng),9,P))),128))],512)):h("",!0),i.gamePhase!=="completed"?(a(),l("div",H,[(a(!0),l(m,null,d(i.currentGameData.columns,n=>(a(),l("div",{key:n.id,class:"column"},[e("div",N,u(n.title),1),e("div",{ref_for:!0,ref:c=>{i.columnRefs[n.id]=c},class:"column-content"},[(a(!0),l(m,null,d(o.getItemsInColumn(n.id),c=>(a(),l("div",{key:c.id,class:"word-card in-column","data-id":c.id},u(c.eng),9,T))),128))],512)]))),128))])):h("",!0),i.gamePhase==="completed"?(a(),l("div",x,[e("div",E,[t[7]||(t[7]=e("h3",null,"\u{1F389} \u041F\u043E\u0437\u0434\u0440\u0430\u0432\u043B\u044F\u0435\u043C!",-1)),t[8]||(t[8]=e("p",null,"\u0412\u044B \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0437\u0430\u0432\u0435\u0440\u0448\u0438\u043B\u0438 \u0437\u0430\u0434\u0430\u043D\u0438\u0435!",-1)),e("div",V,[e("p",null,"\u041F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u043E \u0440\u0430\u0441\u043F\u0440\u0435\u0434\u0435\u043B\u0435\u043D\u043E: "+u(i.completedItems.size)+" \u0438\u0437 "+u(i.currentGameData.items.length),1),e("p",null,"\u041F\u0440\u043E\u0446\u0435\u043D\u0442 \u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u044B\u0445 \u043E\u0442\u0432\u0435\u0442\u043E\u0432: "+u(o.percentage)+"%",1)]),e("div",B,[e("button",{onClick:t[0]||(t[0]=(...n)=>o.goToResults&&o.goToResults(...n)),class:"control-button results"}," \u{1F4CA} \u041F\u043E\u0441\u043C\u043E\u0442\u0440\u0435\u0442\u044C \u0440\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442\u044B "),e("button",{onClick:t[1]||(t[1]=(...n)=>o.initializeGame&&o.initializeGame(...n)),class:"control-button restart"}," \u{1F504} \u041D\u0430\u0447\u0430\u0442\u044C \u0437\u0430\u043D\u043E\u0432\u043E ")])])])):(a(),l("div",q,[e("button",{onClick:t[2]||(t[2]=(...n)=>o.checkAnswers&&o.checkAnswers(...n)),class:v(["control-button",o.buttonClass]),disabled:!o.allWordsPlaced},u(o.buttonText),11,F),e("button",{onClick:t[3]||(t[3]=(...n)=>o.toggleHints&&o.toggleHints(...n)),class:"control-button hint"},u(i.showHints?"\u{1F648} \u0421\u043A\u0440\u044B\u0442\u044C \u043F\u043E\u0434\u0441\u043A\u0430\u0437\u043A\u0438":"\u{1F4A1} \u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u043F\u043E\u0434\u0441\u043A\u0430\u0437\u043A\u0438"),1),e("button",{onClick:t[4]||(t[4]=(...n)=>o.resetGame&&o.resetGame(...n)),class:"control-button reset"}," \u{1F504} \u0421\u0431\u0440\u043E\u0441\u0438\u0442\u044C ")]))])}var j=C(k,[["render",M],["__scopeId","data-v-dc04baa4"]]);export{j as default};
