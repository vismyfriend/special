import{u as X,b as w,i as D,B as Y,d as Z,o as r,f as i,h as n,t as p,F as V,q as N,l as _,z as j,j as ee,m as te,n as se,C as ne,s as le}from"./index.ffc2f955.js";import{d as ae}from"./definitions-data.5d8a2bb8.js";import{_ as oe}from"./plugin-vue_export-helper.21dcd24c.js";const re={key:0,class:"game-container"},ie={class:"progress-info"},ce={key:0,class:"cards-grid"},ue=["onClick","title"],de={class:"definition-section"},pe=["innerHTML"],me={key:0,class:"translation"},he=["innerHTML"],ve={key:1,class:"feedback-section"},fe={key:0,class:"attempt-feedback"},ge={class:"attempt-message"},_e={class:"try-again"},Ce={key:1,class:"correct-answer"},we={key:0,class:"attempts-history"},be={class:"correct-answer-message"},Ae={class:"input-section"},ke=["onUpdate:modelValue","onKeyup","disabled"],Te=["onClick","disabled"],ye={key:1,class:"completion-results"},He={class:"results-list"},De={class:"result-answer"},Ie={class:"result-number"},xe={class:"answer-text"},Fe={class:"result-definition"},Me=["innerHTML"],Le={key:2,class:"completion-message"},$e={__name:"GameDefinitions",setup(Ge){const B=X(),b=w([]),a=w([]),c=w([]),u=w(0),f=w(!1),E=D(()=>{const t=Math.max(0,a.value.length-u.value),e=c.value.filter(s=>!s.isCompleted).length;return t+e});D(()=>b.value.length);const K=D(()=>a.value.filter(t=>t.isCompleted));Y(c,t=>{t.filter(s=>s.isCompleted).length>0&&u.value<a.value.length?R():A()},{deep:!0});const S=t=>t.replace(/\s*\([^)]*\)/g,""),I=t=>t.replace(/(\w+)\s*\(([^)]+)\)/g,'<span class="translation-word" data-translation="$2">$1</span>'),x=()=>{const t=B.params.missionName;b.value=ae[t]||[],f.value=!1,a.value=b.value.map(e=>({id:e.id,eng:e.eng,engClean:S(e.eng),engWithTooltips:I(e.eng),ru:e.ru,ruWithTooltips:I(e.ru),ans:e.ans,userAnswer:"",showHintTranslation:!1,showFeedback:!1,attempts:0,allAttempts:[],isCompleted:!1,isCorrect:!1,isIncorrect:!1})),u.value=0,U(),setTimeout(()=>{A()},100)},U=()=>{const t=a.value.slice(u.value,u.value+2);c.value=t.map(e=>({...e,userAnswer:"",showHintTranslation:!1,showFeedback:!1,attempts:0,allAttempts:[],isCompleted:!1,isCorrect:!1,isIncorrect:!1})),u.value+=t.length},R=()=>{const t=[...c.value];let e=!1;for(let s=0;s<t.length;s++)if(t[s].isCompleted&&u.value<a.value.length){const l=a.value.findIndex(m=>m.id===t[s].id);l!==-1&&(a.value[l].isCompleted=!0);const o=a.value[u.value];t[s]={...o,userAnswer:"",showHintTranslation:!1,showFeedback:!1,attempts:0,allAttempts:[],isCompleted:!1,isCorrect:!1,isIncorrect:!1},u.value++,e=!0}e?c.value=t:t.every(l=>l.isCompleted)&&u.value>=a.value.length&&(t.forEach(l=>{const o=a.value.findIndex(m=>m.id===l.id);o!==-1&&(a.value[o].isCompleted=!0)}),A())},W=t=>{c.value[t].showHintTranslation=!c.value[t].showHintTranslation},F=t=>{const e=c.value[t];if(e.isCompleted)return;if(!e.userAnswer.trim()){e.isCorrect=!1,e.isIncorrect=!0,e.showHintTranslation=!1,e.showFeedback=!0,e.attempts+=1,e.allAttempts.push(" - "),e.userAnswer="",setTimeout(()=>{e.isIncorrect=!1},2e3);return}J(e.userAnswer,e.ans)?(e.isCorrect=!0,e.isIncorrect=!1,e.showFeedback=!1,setTimeout(()=>{e.isCompleted=!0;const l=a.value.findIndex(o=>o.id===e.id);l!==-1&&(a.value[l].isCompleted=!0),A()},800)):(e.isCorrect=!1,e.isIncorrect=!0,e.showHintTranslation=!1,e.showFeedback=!0,e.attempts+=1,e.allAttempts.push(e.userAnswer),e.userAnswer="",setTimeout(()=>{e.isIncorrect=!1},2e3))},A=()=>{a.value.length>0&&a.value.every(e=>e.isCompleted)&&!f.value&&setTimeout(()=>{f.value=!0},500)},M=()=>{f.value=!1,x()},L=t=>!t||typeof t!="string"?"":t.toLowerCase().replace(/\s+/g," ").trim().replace(/[.,!?;:…–—]+$/g,"").replace(/[.,!?;:…–—]/g," ").replace(/\s+/g," ").replace(/[`'‘’´]/g,"'").replace(/\bdo not\b/g,"don't").replace(/\bdoes not\b/g,"doesn't").replace(/\bdid not\b/g,"didn't").replace(/\bwill not\b/g,"won't").replace(/\bcan not\b/g,"can't").replace(/\b(?:dont|doesnt|didnt|wont|cant)\b/g,e=>({dont:"don't",doesnt:"doesn't",didnt:"didn't",wont:"won't",cant:"can't"})[e]).replace(/\s+/g," ").trim(),q=(t,e)=>{if(t===e)return!0;const s=["he","his","she","her","you","your","we","our","it","is","are","was","were","do","does","did","have","has","had","who","why"],l=e.length<=3;if(s.includes(e)||l||Math.abs(t.length-e.length)>1)return!1;let o=0;const m=Math.max(t.length,e.length);for(let h=0,C=0;h<m||C<m;h++,C++)if(h>=t.length||C>=e.length||t[h]!==e[C]){if(o++,o>1)return!1;t.length>e.length?C--:t.length<e.length&&h--}return!0},J=(t,e)=>{const s=L(t),l=L(e);if(s===l)return!0;const o=d=>d?["a","e","i","o","u"].some(v=>d.toLowerCase().startsWith(v))?"an":"a":"",m=(d,g)=>{const v=d.split(" "),k=g.split(" "),y=v.length>1&&(v[0]==="a"||v[0]==="an"),H=k.length>1&&(k[0]==="a"||k[0]==="an");if(y&&H)return v[0]===k[0];if(y&&!H){const O=v[0],P=v[1],Q=o(P);return O===Q}else if(!y&&H)return!0;return!0},h=d=>d.replace(/^\s*(a|an)\s+/i,"").replace(/\s+/g," ").trim();if(!m(s,l))return!1;const $=h(s),G=h(l);if($===G)return!0;const z=$.split(" "),T=G.split(" ");if(z.length===T.length){let d=!0;for(let g=0;g<T.length;g++)if(!q(z[g],T[g])){d=!1;break}if(d)return!0}return!1};return Z(()=>{x()}),(t,e)=>b.value?(r(),i("div",re,[n("div",ie,[n("p",null,"\u041E\u0441\u0442\u0430\u043B\u043E\u0441\u044C: "+p(E.value)+" \u043E\u043F\u0440\u0435\u0434\u0435\u043B\u0435\u043D\u0438\u0439 ",1)]),f.value?_("",!0):(r(),i("div",ce,[(r(!0),i(V,null,N(c.value,(s,l)=>(r(),i("div",{class:"main-card",key:`${s.id}-${l}`},[n("button",{class:"toggle-hint-btn",onClick:o=>W(l),title:s.showHintTranslation?"\u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u043F\u043E\u043F\u044B\u0442\u043A\u0438":"\u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u043F\u0435\u0440\u0435\u0432\u043E\u0434"},p(s.showHintTranslation?"\u{1F4A1}":"\u{1F4DD}"),9,ue),n("div",de,[e[2]||(e[2]=n("h3",null,"Definition:",-1)),n("p",{class:"english-definition",innerHTML:s.engWithTooltips},null,8,pe),s.showHintTranslation?(r(),i("div",me,[n("p",{innerHTML:s.ruWithTooltips},null,8,he)])):_("",!0),!s.showHintTranslation&&s.showFeedback?(r(),i("div",ve,[s.attempts<4?(r(),i("div",fe,[n("p",ge,[e[0]||(e[0]=j("\u0412\u0430\u0448\u0438 \u043F\u043E\u043F\u044B\u0442\u043A\u0438: ")),n("strong",null,p(s.allAttempts.join(", ")),1)]),n("p",_e,"\u041E\u0442\u0432\u0435\u0442 \u043F\u043E\u044F\u0432\u0438\u0442\u0441\u044F \u0447\u0435\u0440\u0435\u0437 "+p(4-s.attempts)+" \u0432\u0430\u0440\u0438\u0430\u043D\u0442(\u0430)",1)])):(r(),i("div",Ce,[s.allAttempts.length>0?(r(),i("p",we," \u0412\u0430\u0448\u0438 \u043F\u043E\u043F\u044B\u0442\u043A\u0438: "+p(s.allAttempts.join(", ")),1)):_("",!0),n("p",be,[e[1]||(e[1]=j("\u041F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u044B\u0439 \u043E\u0442\u0432\u0435\u0442: ")),n("strong",null,p(s.ans),1)])]))])):_("",!0)]),n("div",Ae,[ee(n("input",{class:se(["answer-input",{correct:s.isCorrect,incorrect:s.isIncorrect}]),type:"text","onUpdate:modelValue":o=>s.userAnswer=o,onKeyup:ne(o=>F(l),["enter"]),placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043E\u0442\u0432\u0435\u0442..",disabled:s.isCompleted},null,42,ke),[[te,s.userAnswer]]),n("button",{class:"check-btn",onClick:o=>F(l),disabled:s.isCompleted},p(s.isCompleted?"\u2713":"\u041F\u0440\u043E\u0432\u0435\u0440\u0438\u0442\u044C"),9,Te)])]))),128))])),f.value?(r(),i("div",ye,[e[3]||(e[3]=n("div",{class:"results-header"},[n("h2",null,"\u{1F389} \u0412\u044B \u0441\u043F\u0440\u0430\u0432\u0438\u043B\u0438\u0441\u044C! \u{1F389}"),n("p",{class:"results-subtitle"})],-1)),n("div",He,[(r(!0),i(V,null,N(K.value,(s,l)=>(r(),i("div",{class:"result-item",key:s.id,style:le({animationDelay:`${l*.1}s`})},[n("div",De,[n("span",Ie,p(l+1)+".",1),n("strong",xe,p(s.ans),1)]),n("div",Fe,[n("p",{class:"english-definition",innerHTML:s.engWithTooltips},null,8,Me)])],4))),128))]),n("div",{class:"results-actions"},[n("button",{class:"restart-btn large",onClick:M}," \u{1F3AE} \u0434\u0440\u0443\u0433\u0438\u0435 \u0441\u043B\u043E\u0432\u0430 ")])])):_("",!0),a.value.length===0&&c.value.length===0&&!f.value?(r(),i("div",Le,[e[4]||(e[4]=n("h3",null,"\u{1F389} \u041F\u043E\u0437\u0434\u0440\u0430\u0432\u043B\u044F\u0435\u043C! \u0412\u044B \u043E\u0442\u0433\u0430\u0434\u0430\u043B\u0438 \u0432\u0441\u0435\u0445 \u043F\u0435\u0440\u0441\u043E\u043D\u0430\u0436\u0435\u0439!",-1)),n("button",{class:"restart-btn",onClick:M},"\u041D\u0430\u0447\u0430\u0442\u044C \u0437\u0430\u043D\u043E\u0432\u043E")])):_("",!0)])):_("",!0)}};var je=oe($e,[["__scopeId","data-v-171a469c"]]);export{je as default};
