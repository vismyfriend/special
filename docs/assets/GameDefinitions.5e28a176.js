import{u as V,b as v,i as b,B as $,d as M,o as u,f as d,h as n,t as i,F as N,q as j,l as g,z as k,j as B,m as K,n as L,C as U}from"./index.c199a531.js";import{d as E}from"./definitions-data.71a2b961.js";import{_ as R}from"./plugin-vue_export-helper.21dcd24c.js";const S={key:0,class:"game-container"},q={class:"progress-info"},J={class:"cards-grid"},O=["onClick","title"],P={class:"definition-section"},Q={class:"english-definition"},X={key:0,class:"translation"},Y={key:1,class:"feedback-section"},Z={key:0,class:"attempt-feedback"},W={class:"attempt-message"},ee={class:"try-again"},te={key:1,class:"correct-answer"},se={class:"correct-answer-message"},ne={key:0,class:"attempts-history"},ae={class:"input-section"},le=["onUpdate:modelValue","onKeyup","disabled"],oe=["onClick","disabled"],re={key:0,class:"completion-message"},ie={__name:"GameDefinitions",setup(ce){const A=V(),f=v([]),p=v([]),l=v([]),c=v(0),y=b(()=>{const s=Math.max(0,p.value.length-c.value),e=l.value.filter(t=>!t.isCompleted).length;return s+e}),T=b(()=>f.value.length);$(l,s=>{s.filter(t=>t.isCompleted).length>0&&c.value<p.value.length&&I()},{deep:!0});const D=s=>s.replace(/\s*\([^)]*\)/g,""),_=()=>{const s=A.params.missionName;f.value=E[s]||[],p.value=f.value.map(e=>({id:e.id,eng:e.eng,engClean:D(e.eng),ru:e.ru,ans:e.ans,userAnswer:"",showHintTranslation:!1,showFeedback:!1,attempts:0,allAttempts:[],isCompleted:!1,isCorrect:!1,isIncorrect:!1})),c.value=0,H()},H=()=>{const s=p.value.slice(c.value,c.value+2);l.value=s.map(e=>({...e,userAnswer:"",showHintTranslation:!1,showFeedback:!1,attempts:0,allAttempts:[],isCompleted:!1,isCorrect:!1,isIncorrect:!1})),c.value+=s.length},I=()=>{const s=[...l.value];let e=!1;for(let t=0;t<s.length;t++)if(s[t].isCompleted&&c.value<p.value.length){const a=p.value[c.value];s[t]={...a,userAnswer:"",showHintTranslation:!1,showFeedback:!1,attempts:0,allAttempts:[],isCompleted:!1,isCorrect:!1,isIncorrect:!1},c.value++,e=!0}e&&(l.value=s)},F=s=>{l.value[s].showHintTranslation=!l.value[s].showHintTranslation},w=s=>{const e=l.value[s];if(e.isCompleted)return;if(!e.userAnswer.trim()){e.isCorrect=!1,e.isIncorrect=!0,e.showHintTranslation=!1,e.showFeedback=!0,e.attempts+=1,e.allAttempts.push("(\u043F\u0443\u0441\u0442\u043E)"),e.userAnswer="",setTimeout(()=>{e.isIncorrect=!1},2e3);return}G(e.userAnswer,e.ans)?(e.isCorrect=!0,e.isIncorrect=!1,e.showFeedback=!1,setTimeout(()=>{e.isCompleted=!0},800)):(e.isCorrect=!1,e.isIncorrect=!0,e.showHintTranslation=!1,e.showFeedback=!0,e.attempts+=1,e.allAttempts.push(e.userAnswer),e.userAnswer="",setTimeout(()=>{e.isIncorrect=!1},2e3))},x=()=>{_()},C=s=>!s||typeof s!="string"?"":s.toLowerCase().replace(/\s+/g," ").trim().replace(/[.,!?;:…–—]+$/g,"").replace(/[.,!?;:…–—]/g," ").replace(/\s+/g," ").replace(/[`'‘’´]/g,"'").replace(/\bdo not\b/g,"don't").replace(/\bdoes not\b/g,"doesn't").replace(/\bdid not\b/g,"didn't").replace(/\bwill not\b/g,"won't").replace(/\bcan not\b/g,"can't").replace(/\b(?:dont|doesnt|didnt|wont|cant)\b/g,e=>({dont:"don't",doesnt:"doesn't",didnt:"didn't",wont:"won't",cant:"can't"})[e]).replace(/\s+/g," ").trim(),z=(s,e)=>{if(s===e)return!0;const t=["he","his","she","her","you","your","we","our","it","is","are","was","were","do","does","did","have","has","had","who","why"],a=e.length<=3;if(t.includes(e)||a||Math.abs(s.length-e.length)>1)return!1;let o=0;const m=Math.max(s.length,e.length);for(let r=0,h=0;r<m||h<m;r++,h++)if(r>=s.length||h>=e.length||s[r]!==e[h]){if(o++,o>1)return!1;s.length>e.length?h--:s.length<e.length&&r--}return!0},G=(s,e)=>{const t=C(s),a=C(e);if(t===a)return!0;const o=t.split(" "),m=a.split(" ");if(o.length!==m.length)return!1;for(let r=0;r<m.length;r++)if(!z(o[r],m[r]))return!1;return!0};return M(()=>{_()}),(s,e)=>f.value?(u(),d("div",S,[n("div",q,[n("p",null,"\u041E\u0441\u0442\u0430\u043B\u043E\u0441\u044C: "+i(y.value)+" \u0438\u0437 "+i(T.value),1)]),n("div",J,[(u(!0),d(N,null,j(l.value,(t,a)=>(u(),d("div",{class:"main-card",key:`${t.id}-${a}`},[n("button",{class:"toggle-hint-btn",onClick:o=>F(a),title:t.showHintTranslation?"\u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u043F\u043E\u043F\u044B\u0442\u043A\u0438":"\u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u043F\u0435\u0440\u0435\u0432\u043E\u0434"},i(t.showHintTranslation?"\u{1F4A1}":"\u{1F4DD}"),9,O),n("div",P,[e[2]||(e[2]=n("h3",null,"Definition:",-1)),n("p",Q,i(t.engClean),1),t.showHintTranslation?(u(),d("div",X,[n("p",null,i(t.ru),1)])):g("",!0),!t.showHintTranslation&&t.showFeedback?(u(),d("div",Y,[t.attempts<3?(u(),d("div",Z,[n("p",W,[e[0]||(e[0]=k("\u0412\u0430\u0448\u0438 \u043F\u043E\u043F\u044B\u0442\u043A\u0438: ")),n("strong",null,i(t.allAttempts.join(", ")),1)]),n("p",ee,"\u041F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437! \u041F\u043E\u043F\u044B\u0442\u043A\u0430 "+i(t.attempts)+" \u0438\u0437 3",1)])):(u(),d("div",te,[n("p",se,[e[1]||(e[1]=k("\u041F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u044B\u0439 \u043E\u0442\u0432\u0435\u0442: ")),n("strong",null,i(t.ans),1)]),t.allAttempts.length>0?(u(),d("p",ne," \u0412\u0430\u0448\u0438 \u043F\u043E\u043F\u044B\u0442\u043A\u0438: "+i(t.allAttempts.join(", ")),1)):g("",!0)]))])):g("",!0)]),n("div",ae,[B(n("input",{class:L(["answer-input",{correct:t.isCorrect,incorrect:t.isIncorrect}]),type:"text","onUpdate:modelValue":o=>t.userAnswer=o,onKeyup:U(o=>w(a),["enter"]),placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u043F\u0435\u0440\u0441\u043E\u043D\u0430\u0436\u0430...",disabled:t.isCompleted},null,42,le),[[K,t.userAnswer]]),n("button",{class:"check-btn",onClick:o=>w(a),disabled:t.isCompleted},i(t.isCompleted?"\u2713":"\u041F\u0440\u043E\u0432\u0435\u0440\u0438\u0442\u044C"),9,oe)])]))),128))]),p.value.length===0&&l.value.length===0?(u(),d("div",re,[e[3]||(e[3]=n("h3",null,"\u{1F389} \u041F\u043E\u0437\u0434\u0440\u0430\u0432\u043B\u044F\u0435\u043C! \u0412\u044B \u043E\u0442\u0433\u0430\u0434\u0430\u043B\u0438 \u0432\u0441\u0435\u0445 \u043F\u0435\u0440\u0441\u043E\u043D\u0430\u0436\u0435\u0439!",-1)),n("button",{class:"restart-btn",onClick:x},"\u041D\u0430\u0447\u0430\u0442\u044C \u0437\u0430\u043D\u043E\u0432\u043E")])):g("",!0)])):g("",!0)}};var me=R(ie,[["__scopeId","data-v-5f4fa886"]]);export{me as default};
